% !TEX encoding = UTF-8 Unicode
% !!!  THIS FILE IS UTF-8 !!!
% !!!  MAKE SURE YOUR LaTeX Editor IS CONFIGURED TO USE UTF-8 !!!

% Computational and Data Science Course Paper LaTeX Template
% University of Applied Sciences of the Grisons
% ---------------------------------------------------------------
% Author: Corsin Capol corsin.capol@fhgr.ch
% ---------------------------------------------------------------

%-------------------------
% header
% ------------------------
\documentclass[a4paper,12pt]{scrartcl}
\linespread {1.25}

%-------------------------
% packages and config
% ------------------------
\input{packages_and_configuration}

%-------------------------
% document begin
%-------------------------
\begin{document}

%-------------------------
% title
%-------------------------
\input{title}
\newpage

\twocolumn

\section{Introduction}
The world's most renowned financial data provider is Bloomberg, recognizable by its distinctive black screen. This terminal is a standard and indispensable tool for major financial institutions and traders worldwide. However an annual subscription to this terminal can easily exceed the cost of \$25'000, making it inaccessible to the retail investor. Consequently, the availability of cheaper or even free financial data providers has significantly increased. The scope of this research is to analyze the quality and consistency of the provided data. \cite{InvestopediaBloombergTerminal}

\subsection{Limiting the scope of the topic}
For this research, only the opening and closing prices of IBM provided by three different providers (\textit{AlphaVantage}, \textit{MarketStack}, \textit{StockData}) were considered. Another limitation have to do with the historical availability of the data: it was only possible to extract information from July 17, 2025, up to present date. Data provided by \textit{SIX Id} was used as the reference dataset.

\section{Methodology}
To achieve the objectives of this research, Python scripts were developed. Both the data used and the scripts themselves are available in a GitHub\footnote{\url{https://github.com/dariohollbach/swiss-news-change-tracker}} repository.
\newline
The initial idea was to compare intraday stock prices, as data consistency plays a crucial role on trading strategies that rely on high precision. Intraday data capture price movements at very fine time intervals (mostly milliseconds). This data-granularity is critical for high-frequency trading, where the computers execute a great number of transactions in fractions of a second. Similarly in quantitative trading, the short-term patterns, volatility spikes and market microstructure effects are often used to exploit minimal price differences.
\newline
In contrast, daily data only provides opening, closing and traded volume of the entire day. This resolution loss may not be relevant for a long-term investor, but it limit its possibilities to detect very short-term arbitrage opportunities.
\newline
However, since none of the APIs provided intraday data for free, the analysis was subsequently shifted to daily data. Despite its reduced detail load, daily data still allows a meaningful comparison between providers.
\newline
The process of collecting and organizing the data was structured in three main phases:

\subsection{API research}
A preliminary analysis was conducted to identify acceptable APIs to fetch financial information. As a basic reference, the list of APIs provided by API Layer was considered \cite{GitHub_PublicAPIs}. The goal was to pick APIs that offered free historical data and that were easily accessible.

At the end the following 3 APIs were selected:

\begin{table}[ht]
\centering
\begin{tabular}{l r}
API Name & provided stock prices \\\hline
AlphaVantage & unadjusted \\
StockData & adjusted \\
MarketStack & un-/ adjusted \\
\end{tabular}
\caption{selected APIs}
\end{table}

\subsection{Development of data extraction code}
To execute the three API calls, essentially the same code structure was used for all providers. The core logic remained unchanged, the only differences were the API-parameters. The scripts were implemented using the standard \texttt{requests} module for the HTTP requests and the \texttt{json} module to parse and manage the returned data. The received data was then saved locally in json format to avoid repeating the API requests during the analysis phase.

\subsection{Data consolidation}
Initially, the analysis was designed with the intention of validating data obtained from two API providers using reference data from \texttt{SIX Id}. During the data collection, it emerged that the stock prices from \textit{StockData} were adjusted \cite{StockData_API_Documentation}, while the data from \textit{AlphaVantage} was unadjusted \cite{AlphaVantage_API_Documentation}. As a result, it was not possible to compare the datasets as the different adjustment lead to inconsistencies in the price series.
\newline

To address this issue, an additional API was selected that provides both adjusted and unadjusted stock prices: \textit{MarketStack} \cite{MarketStack_API_Documentation}.
\newline
Because of the added API two separate Python codes were developed to consolidate the data in the Excel sheet, each tailored to handle the specific data structures and adjustments needed to handle the different datasets.
\newline
The first consolidation script \textit{load create xlsx} is responsible for the initial construction of the overview dataset. In this step, the JSON files obtained from StockData and AlphaVantage are parsed and aligned based on the trading date. Opening prices, closing prices, and trading volumes are extracted and written into a newly created Excel file. For each observation, pairwise differences between providers are computed in order to quantify discrepancies in reported values.
\newline
The second consolidation script \textit{load MarketStack} extends the existing Excel file by integrating the \textit{MarketStack} data. Instead of recreating the dataset, this script loads the previously generated workbook and updates it in place. The \textit{MarketStack} json data are matched to the corresponding rows using the trading date as a key, and both adjusted and unadjusted values for opening prices, closing prices, and volumes are inserted into predefined columns.
\newline

The \textit{SIX} data was extracted at a later stage of the analysis and was integrated into the spreadsheet. The integration was directly performed in Excel using the \texttt{XLOOKUP} function, matching the dates from the consolidated sheet with the data from \textit{SIX}. The data provided by \textit{SIX} was delivered in an unadjusted format. This was the final step to unify and elaborate the data for the comparative analysis.

\section{Results}
Regardless of whether the data were adjusted or unadjusted, the opening prices showed the largest discrepancies, as the market open is one of the two busiest moments during the trading day \cite{InvestopediaBestTradeTime}. In this phase, even minimal differences in data timestamps can amplify divergences, leading to different opening prices across datasets.
\newpage
\begin{figure}
  \includegraphics[width=\linewidth]{term-paper/img/CategorizedDiffsOpenings.png}
  \caption{Categorized diff prices opening}
  \label{fig:Categorized_diff_opening_prices}
\end{figure}

As for closing prices, their higher level of standardization results in much better coherence across datasets: unadjusted data show 100\% precision, whereas adjusted prices still exhibit significant discrepancies due to the underlying adjustment methodologies applied.

\begin{figure}
  \includegraphics[width=\linewidth]{term-paper/img/CategorizedDiffsClosings.png}
  \caption{Categorized diff prices closing}
  \label{fig:Categorized_diff_closing_prices}
\end{figure}

\subsection{Adjusted Stock prices}

Adjusted prices are inherently subject to variability because they are derived using different adjustment methodologies and assumptions. In particular, multiple types of corporate actions can influence a stock price (dividends, stock splits and reverse splits, ...). Since there is no universally accepted standard definition of what an “adjusted price” should represent, data providers may account for these events using different models, timing rules, and reinvestment assumptions, resulting in different adjusted price series even when they are based on the same underlying raw prices.

\section{Discussion}
The analysis identified several discrepancies in the price data provided by the different financial data providers. Although the datasets are generally consistent, observable differences were found across both opening and closing prices. 

Adjusted prices require particular attention, as the definition of “adjusted” is not standardized across providers. Differences in how corporate actions such as dividends and stock splits are incorporated lead to systematic inconsistencies between adjusted datasets. 

From a practical standpoint, free API-based data providers are generally sufficient for long-term retail investors and educational use cases, where minor pricing discrepancies are unlikely to materially affect outcomes. However, for professional users and algorithmic trading applications, these data sources are inadequate, as even small inconsistencies can significantly impact model performance and execution accuracy.

\newpage
\onecolumn
%-------------------------
% literature
%-------------------------
\bibliography{library}

\end{document}